"use strict";const generatePlayerCardV3=function(n){return`
<div class="mx-2 mt-2 mb-3 d-flex flex-row" id="${n.playerID}">
    <div class="player-icon" id="status-${n.playerID}" data-avatar="${n.avatarID}"></div>
    <div class="ml-3 player-name">${n.player}</div>
</div>`},labels=["0","Â½","1","2","3","5","8","13","21","40","100","?"],PHASE=Object.freeze({Created:0,Voting:1,Results:2,Finished:3}),createChart=function(n,t){return new Chart(n,{type:"doughnut",data:{datasets:[{data:t,backgroundColor:["#FFFF00","#FFAE42","#FFA500","#FF4500","#FF0000","#922B3E","#EE82EE","#324AB2","#0000FF","#0D98BA","#008000","#9ACD32",]}],labels:labels},options:{legend:{display:!1},responsive:!0,animation:{animateScale:!0,animateRotate:!0},plugins:{labels:[{render:function(n){return`${n.label} SP`},fontSize:16,fontStyle:"bold",fontColor:"#FFF"}]}}})},mapVotesToCountAndSetDisplay=function(n){var t=[0,0,0,0,0,0,0,0,0,0,0,0];return n.forEach(function(n){n.vote!==null&&(t[n.vote]+=1,$(`#status-${n.playerID}`).attr("data-vote",labels[n.vote]))}),t},logCaughtErr=function(n){console.error(n.toString())};$(document).ready(function(){var t=undefined,i=PHASE.Created,r=window.sessionStorage.getItem("spc_user_token");const n=(new signalR.HubConnectionBuilder).withUrl("/app/session",{accessTokenFactory:function(){return r}}).withAutomaticReconnect().build();n.start().then(function(){n.onclose(function(){$("#disconnectedModalLong").modal({backdrop:"static",keyboard:!1})})}).catch(logCaughtErr);n.on("PlayerJoined",function(n){if($("#playerlist").has(`#${n.playerID}`).length==0){var t=generatePlayerCardV3(n);$("#playerlist").append(t)}else $(`#status-${n.playerID}`).removeClass("disconnected")});n.on("PlayerDisconnected",function(n){$(`#status-${n.playerID}`).addClass("disconnected")});n.on("PlayerPurged",function(n){$(`#${n.playerID}`).remove()});n.on("ReceiveGameStateFromJoinRoom",function(n){if(n.players.forEach(function(t){var r,u,i;if($("#playerlist").has(`#${t.playerID}`).length||(r=generatePlayerCardV3(t),$("#playerlist").append(r)),u=`#status-${t.playerID}`,i=$(u),t.isModerator&&!i.hasClass("moderator")&&i.addClass("moderator"),t.isObserver&&!i.hasClass("observer")&&i.addClass("observer"),t.vote!=null)switch(n.phase){case PHASE.Results:i.attr("data-vote",labels[t.vote]);i.addClass("display-vote");case PHASE.Voting:case PHASE.Created:i.addClass("voted")}}),n.phase===PHASE.Results&&i!=PHASE.Results){var r=document.getElementById("resultsChart").getContext("2d"),u=mapVotesToCountAndSetDisplay(n.players);t=createChart(r,u);$("#votes-card").html(n.players.filter(function(n){return n.vote!=null}).length);$("#min-card").html(labels[n.low]);$("#max-card").html(labels[n.high]);$("#mode-card").html(labels[n.mode]);$("#results-tab").click()}i=n.phase;document.getElementById("leaveRoomButton").disabled=!1;$("#loginModal").modal("hide");$("#loader-complete").remove()});n.on("PlayerVoted",function(n){var t=`#status-${n.playerID}`;$(t).addClass("voted")});n.on("StartDiscussionPhase",function(n){i=PHASE.Results;var r=mapVotesToCountAndSetDisplay(n.votes),u=document.getElementById("resultsChart").getContext("2d");t===undefined?t=createChart(u,r):(t.data.datasets[0].data=r,t.update());$(".player-icon[data-vote]").addClass("display-vote");$("#votes-card").html(n.votes.length);$("#min-card").html(labels[n.low]);$("#max-card").html(labels[n.high]);$("#mode-card").html(labels[n.mode]);$("#results-tab").click()});n.on("StartVotingPhase",function(){i=PHASE.Voting;$(".vote").removeClass("active");$(".vote").removeClass("focus");$(".player-icon").removeClass("voted");$(".player-icon").removeClass("display-vote");$(".player-icon").attr("data-vote",null);$("#vote-tab").click()});n.on("PlayerChanged",function(n){var t=`#status-${n.playerID}`;n.isObserver?$(t).addClass("observer"):$(t).removeClass("observer");n.isModerator?$(t).addClass("moderator"):$(t).removeClass("moderator")});$(".vote").click(function(t){$(".vote").removeClass("active");$(this).addClass("active");n.invoke("SendVote",{Vote:$(this).attr("data-value")}).catch(function(n){return console.error(n.toString())});t.preventDefault()});$("#revealVote").click(function(){n.invoke("SendResult",{}).catch(function(n){return console.error(n.toString())})});$("#resetVote").click(function(t){n.invoke("BeginVoting",{}).catch(function(n){return console.error(n.toString())});t.preventDefault()});$("#playerIsModerator").change(function(){this.checked?$("#playareamain").addClass("moderator"):$("#playareamain").removeClass("moderator");n.invoke("SendPlayerChange",{Observer:null,Moderator:this.checked}).catch(function(n){return console.error(n.toString())});event.preventDefault()});$("#playerIsObserver").change(function(){n.invoke("SendPlayerChange",{Observer:this.checked,Moderator:null}).catch(function(n){return console.error(n.toString())});event.preventDefault()});$("#relogButton").click(function(){var n=`${window.location.protocol}//${window.location.host}/`;window.location=n})});$(function(){$('[data-toggle="tooltip"]').tooltip({delay:{show:100,hide:100}})});
//# sourceMappingURL=app.min.js.map